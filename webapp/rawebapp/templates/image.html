<!doctype html>
<html lang="en">
<head>
    <link href="{{url_for('static',filename='styles/image.css')}}" rel="stylesheet">
    <title>image</title>

</head>
<body >
<p>&nbsp</p>
<form action="/higher" id="new_img_form">
    <input id="new_image_btn"
           type="submit"
           value=" New Image ">
</form>
<p>&nbsp</p>

<div id="loading_text"  >
    <p>&nbsp</p>
    <p>&nbsp</p>
    <p id="loading_text_inner" ></p>
    <p>&nbsp</p>
    <p>&nbsp</p>
</div>
<script>
    function sleep(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
    }
    async function incrementLoadingText() {
        let par = document.getElementById("loading_text_inner");
        // for (let i = 0; i < 3; i++) {
        //     await sleep(500);
        //     par.textContent = "." +par.textContent + ".";
        // }
        par.textContent =". creating .";
        for (let i = 0; i < 200; i++) {
            await sleep(500);
            par.textContent = "." +par.textContent + ".";
        }
    }

    incrementLoadingText()
</script>
<img id="image" src="{{image_endpoint}}">
<script>
    function removeLoadingText(){
        document.getElementById("loading_text").remove()
    }

    document.getElementById("image").onload = removeLoadingText
</script>
<p>&nbsp</p>
<p>&nbsp</p>
<p>&nbsp</p>
<div >
    <img id="tree_image_content" src="{{tree_image_endpoint}}">

</div>
<p>&nbsp</p>
<p></p>
<div class="bottom_link">
    <a href="{{tree_file_endpoint}}"
       title="Get the tree as JSON file. Using this file, you can extract any node that looks nice, and render on your own PC in any desired resolution, using the source code provide in the link below (some python skills required)."
    >
        Download tree file
    </a>
</div>
<p>
<div id="upload_div">
    <form action="{{tree_file_upload_endpoint}}"
          enctype="multipart/form-data"
          id="upload_form"
          method="POST">
        <label class="upload" for="upload-browse">
            Load from tree file
        </label>
        <input id="upload-browse"
               name="file"
               accept=".json"
               onchange="form.submit()"
               type="file"/>
    </form>
</div>
</p>
<div class="bottom_link">
    <a href="{{large_image_endpoint}}"
       target="_blank"
       title="Get this image in 1920x1920 resolution. Takes 30 seconds or so to render.">
        Get image in HD
    </a>
</div>
<p></p>
<div class="bottom_link">
    <a href="https://github.com/lblonk/simple-random-art"
       title="Link to the app's source code on github.">
        App source code
    </a>
</div>
<div id="expression_tree">
    <p class='expr_extra'>
     Press the 'New Image' button (top of page) to generate a different tree & image
    </p>
    <p class='expr_extra'>
     The images are unique and are generated using math only, through the following process:
    </p>
    <p class='expr_extra'>
        1: A tree of operators (shown above) is generated, by an algorithm that makes random choices of the
        operators to include, <br/>the number of branches and depth of the tree. This process, and the core operators,
        were developed by Andrej Bauer.
    </p>
    <p class='expr_extra'>

        2: The operators are evaluated, starting at the leaves, ending at the root (from right to left in above image),
        resulting in the final image
    </p>
    <p class='expr_extra'>
        Operators are can be simple; for example 'ReturnX' just returns the pixels x -coordinates as values
        for red, green and blue. More complex operators, for example 'Mix' or 'Sine', take the output of one or more
        other operators and operate on those.<br/> The 'Mandle' operator evaluates the Mandlebrot set,
        at a random location chosen from an inventory of interesting locations composed by David Eck. <br/>
        The Mandlebrot operator,  tree visualisation, numpy implementation and this webapp were added by Lindert Blonk
    </p>
    <!--    <div id="ascii_content">-->
    <!--        <pre>{{expression_tree}}</pre>-->
    <!--    </div>-->
    <p>&nbsp</p>

</div>
<p>&nbsp</p>
<p>&nbsp</p>
<p>&nbsp</p>
<p>&nbsp</p>
</body>
</html>
